function alpha=calab(s,t,pp) 

% m file for calculating alpha given s, t and p
% function alpha=calab(s,t,p) 
%
%   WILL ONLY WORK FOR P == 0.  (????)
%
% Created: JCS/DAS - 21APR93

      rho=sw_dens(s,t,pp);        % need sw_dens.m 
      sig=(rho-1000.);
      t2 = t*t;
      srt = sqrt(s);
      t3 = t2 * t;
      t4 = t3 * t;
   p = pp / 10.;
      p2 = p*p;
      s32 = srt * s;
      kstp = 54.6746*s - 0.603459*t*s + 0.0109987*t2*s - 6.167e-5*t3*s ...
           + 148.4206*t - 2.327105*t2 + 0.01360477*t3 - 5.155288e-5*t4 ...
           + 19652.21 + 0.07944*s32 + 0.016483*t*s32 - 5.3009e-4*t2*s32 ...
           + 3.239908*p + 0.00143713*t*p + 1.16092e-4*t2*p ...
           - 5.77905e-7*t3*p + 0.0022838*s*p - 1.0981e-5*t*s*p ...
           - 1.6078e-6*t2*s*p + 1.91075e-4*s32*p + 8.50935e-5*p2 ...
           - 6.12293e-6*t*p2 + 5.2787e-8*t2*p2 - 9.9348e-7*s*p2 ...
           + 2.0816e-8*t*s*p2 + 9.1697e-10*t2*s*p2;

      dsdt = 0.06793952 - 0.0040899*s + 1.0227e-4*s32 ...
             + 2*t*(-0.00909529 + 7.6438e-5*s - 1.6546e-6*s32) ...
             + 3*t2*(1.001685e-4 - 8.2467e-7*s) ...
             + 4*t3*(-1.120083e-6 + 5.3875e-9*s) + 5*t4*6.536332e-9;

      dsds = 0.824493 - 0.0040899*t + 7.6438e-5*t2 - 8.2467e-7*t3 ...
             + 5.3875e-9*t4 + 1.5*srt*(-0.00572466 + 1.0227e-4*t ...
             - 1.6546e-6*t2) + 2*s*4.8314e-4;

      dkdt = -0.603459*s + 148.4206 + 0.016483*s32 + 0.00143713*p ...
             - 1.0981e-5*s*p - 6.12293e-6*p2 + 2.0816e-8*s*p2 ...
             + 2*t*(0.0109987*s - 2.327105 - 5.3009e-4*s32 + 1.16092e-4*p ...
             - 1.6078e-6*s*p + 5.2787e-8*p2 + 9.1697e-10*s*p2) ...
             + 3*t2*(-6.167e-5*s + 0.01360477 - 5.77905e-7*p) ...
             - 4*t3*5.155288e-5;

      dkds = 54.6746 - 0.603459*t + 0.0109987*t2 - 6.167e-5*t3 ...
             + 0.0022838*p - 1.0981e-5*t*p - 1.6078e-6*t2*p - 9.9348e-7*p2 ...
             + 2.0816e-8*t*p2 + 9.1697e-10*t2*p2 ...
             + 1.5*srt*(0.07944 + 0.016483*t - 5.3009e-4*t2 + 1.91075e-4*p);

      kstpp = 1./(kstp - p);

      dsigdt = dsdt*kstp*kstpp + sig*dkdt*kstpp - sig*kstp*kstpp*kstpp*dkdt;
%      dsigds = dsds*kstp*kstpp + sig*dkds*kstpp - sig*kstp*kstpp*kstpp*dkds;

%c      dsigdt = dsigdt/1000.
%c      dsigds = dsigds/1000.

      alpha = - (1./rho) * dsigdt;
%      b = (1./rho) * dsigds
